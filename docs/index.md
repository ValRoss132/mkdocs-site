# Отчет о развертывании статического сайта на базе MkDocs

## 1. Демонстрация выполненных действий и результаты развертывания

### Цель

Настроить полностью автоматизированный процесс Continuous Integration/Continuous Deployment (CI/CD) для статического сайта на базе MkDocs с развертыванием в двух средах:

1.  **GitHub Pages**
2.  **Сервер Helios**

### Использованные инструменты

| Категория   | Инструмент                                                 | Роль                                                                       |
| :---------- | :--------------------------------------------------------- | :------------------------------------------------------------------------- |
| **Сайт**    | MkDocs, Markdown                                           | Генерация статического контента.                                           |
| **Среда**   | Python, Virtual Environment (venv)                         | Локальное изолированное окружение для разработки.                          |
| **CI/CD**   | GitHub Actions, YAML                                       | Автоматизация сборки и деплоя.                                             |
| **Деплой**  | SSH, rsync                                                 | Безопасное подключение и синхронизация файлов с сервером Helios (FreeBSD). |
| **Хостинг** | GitHub Pages, Сервер Helios (https://se.ifmo.ru/~sXXXXXX/) | Целевые среды для публикации.                                              |

### Начальная настройка проекта (Локальная среда)

Проект был создан и настроен на локальной машине с использованием Python для изоляции зависимостей.

1.  **Создание виртуального окружения (venv):**

    ```bash
    python3 -m venv venv
    ```

2.  **Активация окружения:**

    ```bash
    source venv/bin/activate
    ```

3.  **Установка MkDocs:**

    ```bash
    pip install mkdocs
    ```

4.  **Инициализация проекта MkDocs:**

    ```bash
    mkdocs new .
    ```

5.  **Локальная проверка:** Проект был запущен для проверки корректности настройки:

    ```bash
    mkdocs serve
    ```

6.  **Наполнение контентом:** В файл `index.md` был добавлен основной отчет, а в файл `mkdocs.yml` настроена тема и навигация.

### Выполненные действия по развертыванию

Для обеспечения двойного деплоя был настроен единый рабочий процесс (`.github/workflows/action.yml`). Процесс настройки включал следующие шаги:

#### A. Подготовка SSH-аутентификации

1.  **Генерация SSH-ключа:** На локальной машине была сгенерирована пара SSH-ключей командой `ssh-keygen` **без парольной фразы** (passphrase).
2.  **Добавление публичного ключа на Helios:** Публичный ключ (`id_rsa.pub`) был добавлен в файл `~/.ssh/authorized_keys` на сервере Helios.
3.  **Устранение ошибок аутентификации:** Были установлены строгие права доступа для директории и файла: `chmod 700 ~/.ssh` и `chmod 600 ~/.ssh/authorized_keys`. Также было исправлено имя файла на `authorized_keys` (множественное число).
4.  **Получение ключа хоста:** Был получен публичный ключ самого сервера Helios командой `ssh-keyscan -p 2222 helios.cs.ifmo.ru`.

#### B. Конфигурация GitHub Secrets

Были созданы три секрета в настройках репозитория на GitHub:

1.  `PRIVATE_SSH_KEY`: Содержимое приватного ключа (полностью, включая заголовки).
2.  `KNOWN_HOSTS`: Полный вывод команды `ssh-keyscan`.
3.  `REMOTE_DEST`: Строка назначения для `rsync`: `sXXXXXX@helios.cs.ifmo.ru:public_html`.

#### C. Настройка YAML-файла CI/CD (Финальная конфигурация)

Рабочий процесс был настроен в файле `.github/workflows/action.yml` по методу чистого SSH, аналогично тому, как это было реализовано преподавателем:

1.  **Сборка:** Сайт собирается с помощью `mkdocs build`, создавая папку `./site`.
2.  **Настройка SSH (Конфигурация):** В шаге `Configure SSH and Private Key` приватный ключ и ключ хоста записываются во временные файлы `~/.ssh/id_rsa` и `~/.ssh/known_hosts` на раннере.
3.  **Деплой на Helios (Rsync):** Используется чистый `rsync` с принудительным указанием SSH-порта и ключа для синхронизации локальной папки `./site` с удаленной `public_html`:
    ```bash
    rsync -ave "ssh -p 2222 -i ~/.ssh/id_rsa -o StrictHostKeyChecking=yes" --delete ./site/ ${{ secrets.REMOTE_DEST }}
    ```
4.  **Деплой на Pages:** Выполняется стандартный деплой артефакта через `actions/deploy-pages@v4`.

---

### URL-адреса опубликованного сайта

| Среда             | URL-адрес                                   |
| :---------------- | :------------------------------------------ |
| **Helios (ИТМО)** | `https://se.ifmo.ru/~s475087/`              |
| **GitHub Pages**  | `https://valross132.github.io/mkdocs-site/` |

---

## 2. Исследования

### 2.1. Возможности использования отечественных CDN для ускорения доставки контента

**CDN (Content Delivery Network)** — это сеть географически распределенных серверов, которые кэшируют статический контент (изображения, стили, скрипты) и доставляют его пользователю с ближайшего узла, что сокращает задержку (latency) и ускоряет загрузку.

-   **Назначение:** Ускорение работы сайта для пользователей, находящихся в России и СНГ, а также повышение отказоустойчивости.
-   **Отечественные примеры:**
    1.  **Яндекс.Облако CDN (Yandex Cloud CDN):** Предоставляет мощную сеть узлов (PoP) по России и миру, интегрированную с другими облачными сервисами Яндекса. Подходит для высоконагруженных проектов.
    2.  **Mail.ru Cloud Solutions CDN (MCS CDN):** Сеть доставки контента от VK. Также имеет широкое покрытие в России и часто используется для проектов, требующих соблюдения российского законодательства о хранении данных.
    3.  **Content Delivery Network (CDNvideo/Gcore):** Хотя Gcore имеет международное присутствие, исторически предоставляет значительную долю услуг на российском рынке, предлагая решения для потокового видео и большого статического контента.

### 2.2. Возможности Gitverse для реализации CI/CD

**Gitverse** (ранее известный как GitFlic) — это российская платформа для разработки, основанная на Git. Она является аналогом GitHub/GitLab и активно развивается как отечественное решение для импортозамещения.

-   **CI/CD в Gitverse:** Платформа предоставляет встроенный инструмент **Gitverse CI/CD**, который является аналогом GitHub Actions или GitLab CI.
    -   **Принцип работы:** Использует YAML-файлы для описания конвейеров сборки, тестирования и развертывания.
    -   **Возможности:** Позволяет запускать сборку контейнеров (Docker), выполнять скрипты `bash` на раннерах, интегрироваться с облачными хранилищами и деплоить на VDS/VPS, используя SSH-ключи, аналогично тому, как это было реализовано в данном отчете.
-   **Преимущества:** Полностью соответствует требованиям по локализации и хранению кода в российском сегменте, что может быть критично для государственных или крупных российских компаний.

### 2.3. Варианты деплоя статического сайта в продакшен среду и технические инструменты

Статический сайт (HTML, CSS, JS) можно развернуть множеством способов, в зависимости от требований к масштабируемости, стоимости и сложности.

| Вариант деплоя              | Описание                                                                                                     | Технические инструменты                                                                | Примеры                                                                                             |
| :-------------------------- | :----------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------- |
| **1. Cloud Storage**        | Размещение файлов в облачном хранилище с возможностью прямого доступа по HTTP. Очень дешево и масштабируемо. | AWS S3, Google Cloud Storage, Яндекс.Облако S3-совместимое хранилище.                  | Облачные CLI-утилиты (`aws s3 sync`), CI/CD для синхронизации.                                      |
| **2. CDN Edge/Serverless**  | Использование CDN, которая может не только кэшировать, но и служить основным хостингом (Edge Computing).     | Cloudflare Pages, Netlify, Vercel.                                                     | Интеграция с Git-репозиторием (Git-based CI/CD)                                                     |
| **3. Традиционный VDS/VPS** | Размещение на виртуальном сервере (как Helios), где файлы раздаются через веб-сервер.                        | **Веб-серверы:** Nginx, Apache. **Передача:** SSH, SCP, **rsync** (как в нашем CI/CD). | Деплой на выделенные серверы, Kubernetes (если статика — часть приложения).                         |
| **4. Контейнеризация**      | Упаковка статики внутри Docker-образа (например, Nginx-контейнера) и его запуск.                             | Docker, Docker-Compose, Kubernetes (K8s).                                              | `Dockerfile` (с `FROM nginx:latest`), GitLab CI/CD или GitHub Actions для сборки и пуша в Registry. |
